/*
 *  test_poisson_generator_ps.sli
 *
 *  This file is part of NEST
 *
 *  Copyright (C) 2009 by
 *  The NEST Initiative
 *
 *  See the file AUTHORS for details.
 *
 *  Permission is granted to compile and modify
 *  this file for non-commercial use.
 *  See the file LICENSE for details.
 *
 */


/* BeginDocumentation
Name: testsuite::test_poisson_ps_min_interval - checks that intervals are independent of tic size

Synopsis: (test_poisson_ps_min_interval) run -> minimum interal close to 0

Description:
 The inter spike interval (ISI) distribution of a Poisson process is 
 exponential. The test verifies that the minimum interval is arbitrarily 
 small and not constrained by the ms_per_tic property of the simlation kernel.
Remarks:
 Even a correct implementation generates with low probability spike trains where the
 minimal interval is larger than ms_per_tic. The seed set in the default configuration 
 of NEST avoids this problem. Therefore, failure of this script indicates that the
 configuration is not portable.
FirstVersion: February 2009
Author: Diesmann
*/


/unittest (6688) require
/unittest using


M_ERROR setverbosity




10000.0 /T Set


0 << /resolution 0.1  >> SetStatus


/spike_detector Create /sp Set
sp  << /precise_times true >> SetStatus


/poisson_generator_ps Create /pn Set
pn << /rate 12892.25 >> SetStatus


pn sp Connect


T Simulate

sp [/events /times] get cva                     % spike train
  2 1 Partition Transpose {sub neg} MapThread   % inter spike intervals
  Min


0 /ms_per_tic get 10.0 div lt  assert_or_die    % should converge to 0

