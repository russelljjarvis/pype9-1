/* Testscript 
  

tests for the correctness of calibration to the new 
resolution after kernel reset. In particular the 
correct calculation of the default delay and consequently
also the mindelay.
Using this test the problem described in ticket #164 which
is connected to the solution of #120 was investigated 
and fixed.

*/

/unittest (6688) require
/unittest using


/Transmission
{
 /d Set

0.01 /h Set

3.0 /T Set 

ResetKernel

0 d                    SetStatus
0 << /resolution h >>  SetStatus

/spike_detector Create /sp Set   
sp  << /withgid false  /withtime true /to_memory true >> SetStatus
 
/poisson_generator_ps Create /pn Set
pn << /rate 10000.0 >> SetStatus

pn sp Connect

T Simulate 

sp [/events /times ] get cva length

} def

<< /local_num_threads 1 >> Transmission
<<                      >> Transmission
eq


assert_or_die
