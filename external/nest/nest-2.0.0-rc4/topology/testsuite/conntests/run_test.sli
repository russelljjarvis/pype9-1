% expects on stack name of script to run to set
% src_layer -- layer dict
% tgt_layer -- layer dict
% conns     -- connection dict

/script Set

% extract file name without trunk and suffix as test name
/testname (.*/|.sli) () script regex_replace def
/outtrunk (output/) testname join def

(Testing: ) testname join ==

ResetKernel

script run % defines parameters

userdict /resolution known { 0 << /resolution resolution >> SetStatus } if

topology using

/sources src_layer CreateLayer def
/targets tgt_layer CreateLayer def

sources targets conns ConnectLayers

outtrunk (_sources.lyr) join (w) file sources DumpLayerNodes close 
outtrunk (_targets.lyr) join (w) file targets DumpLayerNodes close 
outtrunk (_sources.cnn) join (w) file sources /static_synapse DumpLayerConnections close

endusing